<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />

    <!-- das hier stellst Du ganz oben rein -->
    <style>
      /* ganz egal, ob Dein Bild l√§dt oder nicht, der K√∂rper kriegt immer erst diese Farbe */
      body {
        background-color: #0e0501 !important;
      }
    </style>

    <!-- unser Haupt‚ÄêCSS inklusive Hintergrund -->
    <link rel="stylesheet" href="/styles.css" />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link 
    href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" 
    rel="stylesheet"
  />
  

  <title>Flashcards</title>
  <style>
    body { font-family: sans-serif; max-width: 600px; margin: auto; }
    .card { border: 1px solid #ccc; padding: 1em; margin: .5em 0; position: relative; }
    button { margin-right: .5em; }
  </style>
</head>
<!-- index.html -->

<body>
  <h1>Flashcards</h1>

  <!-- Steuer-Panel: ID controls -->
  <div id="controls">
    Seite:
    <input id="page" type="number" value="1" min="1" style="width:3em;">
    pro Seite:
    <input id="per_page" type="number" value="20" min="1" style="width:3em;">
    <button onclick="load()">Laden</button>
    <button onclick="go(-1)">‚Üê Prev</button>
    <button onclick="go(1)">Next ‚Üí</button>
  </div>

  <div id="cards"></div>
  <!-- ‚Ä¶ dein Script ‚Ä¶ -->
</body>

  <script>
    // L√§dt die Karten f√ºr die aktuelle Seite
    async function load() {
      // 1) Werte auslesen
      const pageInput = document.getElementById('page');
      const perPageInput = document.getElementById('per_page');
      const p  = parseInt(pageInput.value) || 1;
      const pp = parseInt(perPageInput.value) || 20;
  
      // 2) Fetch
      const res = await fetch(`/flashcards?page=${p}&per_page=${pp}`);
      const data = await res.json();
  
      // 3) Input-Feld immer mit der tats√§chlichen Seite f√ºllen
      pageInput.value = data.page;
  
      // 4) √úberschrift
      const container = document.getElementById('cards');
      container.innerHTML = 
        `<p>Gesamt: ${data.total} Karten (Seite ${data.page}/${Math.ceil(data.total/pp)})</p>`;
  
      // 5) Karten rendern
      for (const c of data.cards) {
        const el = document.createElement('div');
        el.className = 'card';
        el.id = `card-${c.id}`;
        el.innerHTML = `
          <strong>${c.question}</strong><br>
          <em id="ans-${c.id}" style="display:none">${c.answer}</em><br>
          <small>N√§chste Review: ${c.next_review}</small><br>
          <button onclick="toggleAnswer(${c.id})">Antwort zeigen</button>
          <button onclick="review(${c.id})">‚úîÔ∏è Review</button>
          <button onclick="delCard(${c.id})">üóëÔ∏è L√∂schen</button>
        `;
        container.appendChild(el);
      }
    }
  
    // Review-Request und Datum aktualisieren
    async function review(id) {
      await fetch(`/flashcards/${id}`, { method: 'PUT' });
      const small = document.querySelector(`#card-${id} small`);
      const next = new Date(Date.now() + 24*3600*1000)
                     .toISOString().slice(0,10);
      small.textContent = `N√§chste Review: ${next}`;
    }
  
    // Delete-Request und Karte aus dem DOM nehmen
    async function delCard(id) {
      await fetch(`/flashcards/${id}`, { method: 'DELETE' });
      document.getElementById(`card-${id}`).remove();
    }
  
    // Antwort ein-/ausblenden
    function toggleAnswer(id) {
      const el = document.getElementById(`ans-${id}`);
      el.style.display = el.style.display === 'none' ? 'block' : 'none';
    }
  
    // Vor-/Zur√ºck-Navigation
    function go(delta) {
      const pageInput = document.getElementById('page');
      const current = parseInt(pageInput.value) || 1;
      const nextPage = current + delta;
      if (nextPage < 1) return;
      pageInput.value = nextPage;
      load();
    }
  
    // Buttons im HTML so verwenden:
    // <button onclick="go(-1)">‚Üê Prev</button>
    // <button onclick="go( 1)">Next ‚Üí</button>
  
    // beim Laden automatisch erste Seite holen
    window.onload = load;
  </script>
  
</body>
</html>